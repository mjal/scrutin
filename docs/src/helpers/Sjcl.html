<!DOCTYPE html>

<html>
<head>
  <title>Sjcl.res</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="../../docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page_wrapper">
            <div id="jump_page">
              
                
                <a class="source" href="../App.html">
                  src/App.res
                </a>
              
                
                <a class="source" href="../Core.html">
                  src/Core.res
                </a>
              
                
                <a class="source" href="../Route.html">
                  src/Route.res
                </a>
              
                
                <a class="source" href="../State.html">
                  src/State.res
                </a>
              
                
                <a class="source" href="../StateEffect.html">
                  src/StateEffect.res
                </a>
              
                
                <a class="source" href="../StateMsg.html">
                  src/StateMsg.res
                </a>
              
                
                <a class="source" href="Belenios.html">
                  src/helpers/Belenios.res
                </a>
              
                
                <a class="source" href="Config.html">
                  src/helpers/Config.res
                </a>
              
                
                <a class="source" href="Context.html">
                  src/helpers/Context.res
                </a>
              
                
                <a class="source" href="Credential.html">
                  src/helpers/Credential.res
                </a>
              
                
                <a class="source" href="Dimension.html">
                  src/helpers/Dimension.res
                </a>
              
                
                <a class="source" href="EmailValidator.html">
                  src/helpers/EmailValidator.res
                </a>
              
                
                <a class="source" href="IO.html">
                  src/helpers/IO.res
                </a>
              
                
                <a class="source" href="Mailer.html">
                  src/helpers/Mailer.res
                </a>
              
                
                <a class="source" href="PieChart.html">
                  src/helpers/PieChart.res
                </a>
              
                
                <a class="source" href="Sjcl.html">
                  src/helpers/Sjcl.res
                </a>
              
                
                <a class="source" href="URL.html">
                  src/helpers/URL.res
                </a>
              
                
                <a class="source" href="X.html">
                  src/helpers/X.res
                </a>
              
                
                <a class="source" href="../model/Ballot.html">
                  src/model/Ballot.res
                </a>
              
                
                <a class="source" href="../model/Contact.html">
                  src/model/Contact.res
                </a>
              
                
                <a class="source" href="../model/Election.html">
                  src/model/Election.res
                </a>
              
                
                <a class="source" href="../model/ElectionTally.html">
                  src/model/ElectionTally.res
                </a>
              
                
                <a class="source" href="../model/Identity.html">
                  src/model/Identity.res
                </a>
              
                
                <a class="source" href="../model/Transaction.html">
                  src/model/Transaction.res
                </a>
              
                
                <a class="source" href="../model/Trustee.html">
                  src/model/Trustee.res
                </a>
              
            </div>
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>Sjcl.res</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-1">&#x00a7;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-variable language_">module</span> <span class="hljs-title class_">BitArray</span> = {
  type t
}

<span class="hljs-variable language_">module</span> <span class="hljs-title class_">Bn</span> = {
  type t
  @<span class="hljs-title function_">module</span>(<span class="hljs-string">&quot;sjcl-with-all&quot;</span>) @<span class="hljs-keyword">new</span> external <span class="hljs-attr">new</span>: <span class="hljs-function"><span class="hljs-params">string</span> =&gt;</span> t = <span class="hljs-string">&quot;bn&quot;</span>
  @send external <span class="hljs-attr">power</span>: <span class="hljs-function">(<span class="hljs-params">t, int</span>) =&gt;</span> t = <span class="hljs-string">&quot;power&quot;</span>
  @send external <span class="hljs-attr">toString</span>: <span class="hljs-function"><span class="hljs-params">t</span> =&gt;</span> string = <span class="hljs-string">&quot;toString&quot;</span>
  @send external <span class="hljs-attr">mod</span>: <span class="hljs-function">(<span class="hljs-params">t, t</span>) =&gt;</span> t = <span class="hljs-string">&quot;mod&quot;</span>
  @send external <span class="hljs-attr">equals</span>: <span class="hljs-function">(<span class="hljs-params">t, t</span>) =&gt;</span> bool = <span class="hljs-string">&quot;equals&quot;</span>
  @send external <span class="hljs-attr">mulmod</span>: <span class="hljs-function">(<span class="hljs-params">t, t, t</span>) =&gt;</span> t = <span class="hljs-string">&quot;mulmod&quot;</span>
  @send external <span class="hljs-attr">powermod</span>: <span class="hljs-function">(<span class="hljs-params">t, t, t</span>) =&gt;</span> t = <span class="hljs-string">&quot;powermod&quot;</span>

  @<span class="hljs-title function_">module</span>(<span class="hljs-string">&quot;sjcl-with-all&quot;</span>) @<span class="hljs-title function_">scope</span>(<span class="hljs-string">&quot;bn&quot;</span>) @val external <span class="hljs-attr">fromBits</span>: <span class="hljs-title class_">BitArray</span>.<span class="hljs-property">t</span> =&gt; t = <span class="hljs-string">&quot;fromBits&quot;</span> 
}

<span class="hljs-variable language_">module</span> <span class="hljs-title class_">Hex</span> = {
  @<span class="hljs-title function_">module</span>(<span class="hljs-string">&quot;sjcl-with-all&quot;</span>) @<span class="hljs-title function_">scope</span>((<span class="hljs-string">&quot;codec&quot;</span>, <span class="hljs-string">&quot;hex&quot;</span>)) @val external <span class="hljs-attr">fromBits</span>: <span class="hljs-title class_">BitArray</span>.<span class="hljs-property">t</span> =&gt; string = <span class="hljs-string">&quot;fromBits&quot;</span>
  @<span class="hljs-title function_">module</span>(<span class="hljs-string">&quot;sjcl-with-all&quot;</span>) @<span class="hljs-title function_">scope</span>((<span class="hljs-string">&quot;codec&quot;</span>, <span class="hljs-string">&quot;hex&quot;</span>)) @val external <span class="hljs-attr">toBits</span>: <span class="hljs-function"><span class="hljs-params">string</span> =&gt;</span> <span class="hljs-title class_">BitArray</span>.<span class="hljs-property">t</span> = <span class="hljs-string">&quot;toBits&quot;</span>
}

<span class="hljs-variable language_">module</span> <span class="hljs-title class_">Utf8String</span> = {
  @<span class="hljs-title function_">module</span>(<span class="hljs-string">&quot;sjcl-with-all&quot;</span>) @<span class="hljs-title function_">scope</span>((<span class="hljs-string">&quot;codec&quot;</span>, <span class="hljs-string">&quot;utf8String&quot;</span>)) @val external <span class="hljs-attr">fromBits</span>: <span class="hljs-title class_">BitArray</span>.<span class="hljs-property">t</span> =&gt; string = <span class="hljs-string">&quot;fromBits&quot;</span>
  @<span class="hljs-title function_">module</span>(<span class="hljs-string">&quot;sjcl-with-all&quot;</span>) @<span class="hljs-title function_">scope</span>((<span class="hljs-string">&quot;codec&quot;</span>, <span class="hljs-string">&quot;utf8String&quot;</span>)) @val external <span class="hljs-attr">toBits</span>: <span class="hljs-function"><span class="hljs-params">string</span> =&gt;</span> <span class="hljs-title class_">BitArray</span>.<span class="hljs-property">t</span> = <span class="hljs-string">&quot;toBits&quot;</span>
}

<span class="hljs-variable language_">module</span> <span class="hljs-title class_">Sha256</span> = {
  @<span class="hljs-title function_">module</span>(<span class="hljs-string">&quot;sjcl-with-all&quot;</span>) @<span class="hljs-title function_">scope</span>((<span class="hljs-string">&quot;hash&quot;</span>,<span class="hljs-string">&quot;sha256&quot;</span>)) @val external <span class="hljs-attr">hash</span>: <span class="hljs-function"><span class="hljs-params">string</span> =&gt;</span> <span class="hljs-title class_">BitArray</span>.<span class="hljs-property">t</span> = <span class="hljs-string">&quot;hash&quot;</span>
}

<span class="hljs-variable language_">module</span> <span class="hljs-title class_">Misc</span> = {
  @<span class="hljs-title function_">module</span>(<span class="hljs-string">&quot;sjcl-with-all&quot;</span>) @<span class="hljs-title function_">scope</span>(<span class="hljs-string">&quot;misc&quot;</span>) @val external <span class="hljs-attr">pbkdf2</span>: <span class="hljs-function">(<span class="hljs-params">string, string, int, int</span>) =&gt;</span> <span class="hljs-title class_">BitArray</span>.<span class="hljs-property">t</span> = <span class="hljs-string">&quot;pbkdf2&quot;</span>
}

<span class="hljs-variable language_">module</span> <span class="hljs-title class_">Cipher</span> = {
  type t
  @send external <span class="hljs-attr">encrypt</span>: <span class="hljs-function">(<span class="hljs-params">t, BitArray.t</span>) =&gt;</span> <span class="hljs-title class_">BitArray</span>.<span class="hljs-property">t</span> = <span class="hljs-string">&quot;encrypt&quot;</span>
  <span class="hljs-variable language_">module</span> <span class="hljs-title class_">Aes</span> = {
    @<span class="hljs-title function_">module</span>(<span class="hljs-string">&quot;sjcl-with-all&quot;</span>) @<span class="hljs-title function_">scope</span>(<span class="hljs-string">&quot;cipher&quot;</span>) @<span class="hljs-keyword">new</span> external <span class="hljs-attr">_new</span>: <span class="hljs-title class_">BitArray</span>.<span class="hljs-property">t</span> =&gt; t = <span class="hljs-string">&quot;aes&quot;</span>
  }
}

<span class="hljs-variable language_">module</span> <span class="hljs-title class_">Mode</span> = {
  <span class="hljs-variable language_">module</span> <span class="hljs-variable constant_">CCM</span> = {
    @<span class="hljs-title function_">module</span>(<span class="hljs-string">&quot;sjcl-with-all&quot;</span>) @<span class="hljs-title function_">scope</span>(<span class="hljs-string">&quot;mode&quot;</span>) @val external <span class="hljs-attr">encrypt</span>: <span class="hljs-function">(<span class="hljs-params">Cipher.t, BitArray.t, BitArray.t</span>) =&gt;</span> <span class="hljs-title class_">BitArray</span>.<span class="hljs-property">t</span> = <span class="hljs-string">&quot;encrypt&quot;</span>
    @<span class="hljs-title function_">module</span>(<span class="hljs-string">&quot;sjcl-with-all&quot;</span>) @<span class="hljs-title function_">scope</span>(<span class="hljs-string">&quot;mode&quot;</span>) @val external <span class="hljs-attr">decrypt</span>: <span class="hljs-function">(<span class="hljs-params">Cipher.t, BitArray.t, BitArray.t</span>) =&gt;</span> <span class="hljs-title class_">BitArray</span>.<span class="hljs-property">t</span> = <span class="hljs-string">&quot;decrypt&quot;</span>
  }
}

<span class="hljs-variable language_">module</span> <span class="hljs-title class_">Random</span> = {
  @<span class="hljs-title function_">module</span>(<span class="hljs-string">&quot;sjcl-with-all&quot;</span>) @<span class="hljs-title function_">scope</span>(<span class="hljs-string">&quot;random&quot;</span>) @val external <span class="hljs-attr">randomWords</span>: <span class="hljs-function"><span class="hljs-params">int</span> =&gt;</span> <span class="hljs-title class_">BitArray</span>.<span class="hljs-property">t</span> = <span class="hljs-string">&quot;randomWords&quot;</span>
}

<span class="hljs-variable language_">module</span> <span class="hljs-title class_">Ecc</span> = {
  <span class="hljs-variable language_">module</span> <span class="hljs-title class_">Curve</span> = {
    type t
    @<span class="hljs-title function_">module</span>(<span class="hljs-string">&quot;sjcl-with-all&quot;</span>) @<span class="hljs-title function_">scope</span>((<span class="hljs-string">&quot;ecc&quot;</span>, <span class="hljs-string">&quot;curves&quot;</span>)) external c192 : t = <span class="hljs-string">&quot;c192&quot;</span>
    @<span class="hljs-title function_">module</span>(<span class="hljs-string">&quot;sjcl-with-all&quot;</span>) @<span class="hljs-title function_">scope</span>((<span class="hljs-string">&quot;ecc&quot;</span>, <span class="hljs-string">&quot;curves&quot;</span>)) external c224 : t = <span class="hljs-string">&quot;c224&quot;</span>
    @<span class="hljs-title function_">module</span>(<span class="hljs-string">&quot;sjcl-with-all&quot;</span>) @<span class="hljs-title function_">scope</span>((<span class="hljs-string">&quot;ecc&quot;</span>, <span class="hljs-string">&quot;curves&quot;</span>)) external c256 : t = <span class="hljs-string">&quot;c256&quot;</span>
    @<span class="hljs-title function_">module</span>(<span class="hljs-string">&quot;sjcl-with-all&quot;</span>) @<span class="hljs-title function_">scope</span>((<span class="hljs-string">&quot;ecc&quot;</span>, <span class="hljs-string">&quot;curves&quot;</span>)) external c384 : t = <span class="hljs-string">&quot;c384&quot;</span>
    @<span class="hljs-title function_">module</span>(<span class="hljs-string">&quot;sjcl-with-all&quot;</span>) @<span class="hljs-title function_">scope</span>((<span class="hljs-string">&quot;ecc&quot;</span>, <span class="hljs-string">&quot;curves&quot;</span>)) external c521 : t = <span class="hljs-string">&quot;c521&quot;</span>
    @<span class="hljs-title function_">module</span>(<span class="hljs-string">&quot;sjcl-with-all&quot;</span>) @<span class="hljs-title function_">scope</span>((<span class="hljs-string">&quot;ecc&quot;</span>, <span class="hljs-string">&quot;curves&quot;</span>)) external k192 : t = <span class="hljs-string">&quot;k192&quot;</span>
    @<span class="hljs-title function_">module</span>(<span class="hljs-string">&quot;sjcl-with-all&quot;</span>) @<span class="hljs-title function_">scope</span>((<span class="hljs-string">&quot;ecc&quot;</span>, <span class="hljs-string">&quot;curves&quot;</span>)) external k224 : t = <span class="hljs-string">&quot;k224&quot;</span>
    @<span class="hljs-title function_">module</span>(<span class="hljs-string">&quot;sjcl-with-all&quot;</span>) @<span class="hljs-title function_">scope</span>((<span class="hljs-string">&quot;ecc&quot;</span>, <span class="hljs-string">&quot;curves&quot;</span>)) external k256 : t = <span class="hljs-string">&quot;k256&quot;</span>
  }

  <span class="hljs-variable language_">module</span> <span class="hljs-title class_">Point</span> = {
    type t
    @<span class="hljs-title function_">module</span>(<span class="hljs-string">&quot;sjcl-with-all&quot;</span>) @<span class="hljs-title function_">scope</span>(<span class="hljs-string">&quot;ecc&quot;</span>) @<span class="hljs-keyword">new</span> external <span class="hljs-attr">new</span>: <span class="hljs-function">(<span class="hljs-params">Curve.t, Bn.t, Bn.t</span>) =&gt;</span> t = <span class="hljs-string">&quot;point&quot;</span>
    @send external <span class="hljs-attr">toBits</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title class_">BitArray</span>.<span class="hljs-property">t</span> = <span class="hljs-string">&quot;toBits&quot;</span>
  }
}

<span class="hljs-variable language_">module</span> <span class="hljs-title class_">Ecdsa</span> = {

  type serialized_t = {
    <span class="hljs-string">&quot;type&quot;</span>: string,
    <span class="hljs-string">&quot;secretKey&quot;</span>: bool,
    <span class="hljs-string">&quot;point&quot;</span>: string,
    <span class="hljs-string">&quot;exponent&quot;</span>: string,
    <span class="hljs-string">&quot;curve&quot;</span>: string
  }

  <span class="hljs-variable language_">module</span> <span class="hljs-title class_">PublicKey</span> = {
    type t

    @<span class="hljs-title function_">module</span>(<span class="hljs-string">&quot;sjcl-with-all&quot;</span>) @<span class="hljs-title function_">scope</span>((<span class="hljs-string">&quot;ecc&quot;</span>, <span class="hljs-string">&quot;ecdsa&quot;</span>)) @<span class="hljs-keyword">new</span> external <span class="hljs-attr">new</span>: <span class="hljs-function">(<span class="hljs-params">Ecc.Curve.t, Bn.t</span>) =&gt;</span> t = <span class="hljs-string">&quot;publicKey&quot;</span>
    @<span class="hljs-title function_">module</span>(<span class="hljs-string">&quot;sjcl-with-all&quot;</span>) @<span class="hljs-title function_">scope</span>((<span class="hljs-string">&quot;ecc&quot;</span>, <span class="hljs-string">&quot;ecdsa&quot;</span>)) @<span class="hljs-keyword">new</span> external <span class="hljs-attr">new2</span>: <span class="hljs-function">(<span class="hljs-params">Ecc.Curve.t, Ecc.Point.t</span>) =&gt;</span> t = <span class="hljs-string">&quot;publicKey&quot;</span>

    @send external <span class="hljs-attr">verify</span>: <span class="hljs-function">(<span class="hljs-params">t, ~hash: BitArray.t, ~signature: BitArray.t</span>) =&gt;</span> bool = <span class="hljs-string">&quot;verify&quot;</span>
    @send external <span class="hljs-attr">serialize</span>: <span class="hljs-function">(<span class="hljs-params">t</span>) =&gt;</span> serialized_t = <span class="hljs-string">&quot;serialize&quot;</span>

    <span class="hljs-keyword">let</span> <span class="hljs-title function_">toHex</span> = (<span class="hljs-params">t</span>) =&gt; <span class="hljs-title function_">serialize</span>(t)[<span class="hljs-string">&quot;point&quot;</span>]
    <span class="hljs-keyword">let</span> <span class="hljs-title function_">fromHex</span> = (<span class="hljs-params">str</span>) =&gt; <span class="hljs-title function_">new</span>(<span class="hljs-title class_">Ecc</span>.<span class="hljs-property">Curve</span>.<span class="hljs-property">c256</span>, <span class="hljs-title class_">Bn</span>.<span class="hljs-title function_">fromBits</span>(<span class="hljs-title class_">Hex</span>.<span class="hljs-title function_">toBits</span>(str)))
  }

  <span class="hljs-variable language_">module</span> <span class="hljs-title class_">SecretKey</span> = {
    type t

    @<span class="hljs-title function_">module</span>(<span class="hljs-string">&quot;sjcl-with-all&quot;</span>) @<span class="hljs-title function_">scope</span>((<span class="hljs-string">&quot;ecc&quot;</span>, <span class="hljs-string">&quot;ecdsa&quot;</span>)) @<span class="hljs-keyword">new</span> external <span class="hljs-attr">new</span>: <span class="hljs-function">(<span class="hljs-params">Ecc.Curve.t, Bn.t</span>) =&gt;</span> t = <span class="hljs-string">&quot;secretKey&quot;</span>

    @send external <span class="hljs-attr">sign</span>: <span class="hljs-function">(<span class="hljs-params">t, BitArray.t</span>) =&gt;</span> <span class="hljs-title class_">BitArray</span>.<span class="hljs-property">t</span> = <span class="hljs-string">&quot;sign&quot;</span>
    @send external <span class="hljs-attr">serialize</span>: <span class="hljs-function">(<span class="hljs-params">t</span>) =&gt;</span> serialized_t = <span class="hljs-string">&quot;serialize&quot;</span>

    <span class="hljs-keyword">let</span> <span class="hljs-title function_">toHex</span> = (<span class="hljs-params">t</span>) =&gt; <span class="hljs-title function_">serialize</span>(t)[<span class="hljs-string">&quot;exponent&quot;</span>]
    <span class="hljs-keyword">let</span> <span class="hljs-title function_">fromHex</span> = (<span class="hljs-params">str</span>) =&gt; <span class="hljs-title function_">new</span>(<span class="hljs-title class_">Ecc</span>.<span class="hljs-property">Curve</span>.<span class="hljs-property">c256</span>, <span class="hljs-title class_">Bn</span>.<span class="hljs-title function_">fromBits</span>(<span class="hljs-title class_">Hex</span>.<span class="hljs-title function_">toBits</span>(str)))
  }

  type t = { <span class="hljs-attr">pub</span>: <span class="hljs-title class_">PublicKey</span>.<span class="hljs-property">t</span>, <span class="hljs-attr">sec</span>: <span class="hljs-title class_">SecretKey</span>.<span class="hljs-property">t</span> }

  @<span class="hljs-title function_">module</span>(<span class="hljs-string">&quot;sjcl-with-all&quot;</span>) @<span class="hljs-title function_">scope</span>((<span class="hljs-string">&quot;ecc&quot;</span>, <span class="hljs-string">&quot;ecdsa&quot;</span>)) external <span class="hljs-attr">_generateKeys</span>: <span class="hljs-function">(<span class="hljs-params">option&lt;Ecc.Curve.t&gt;, option&lt;int&gt;, option&lt;Bn.t&gt;</span>) =&gt;</span> t = <span class="hljs-string">&quot;generateKeys&quot;</span>
  <span class="hljs-keyword">let</span> <span class="hljs-title function_">generateKeys</span> = (<span class="hljs-params"></span>) =&gt; <span class="hljs-title function_">_generateKeys</span>(<span class="hljs-title class_">None</span>, <span class="hljs-title class_">None</span>, <span class="hljs-title class_">None</span>)

  <span class="hljs-keyword">let</span> <span class="hljs-title function_">generateKeysFromSecretKey</span> = (<span class="hljs-params">sec</span>) =&gt; <span class="hljs-title function_">_generateKeys</span>(<span class="hljs-title class_">None</span>, <span class="hljs-title class_">None</span>, <span class="hljs-title class_">Some</span>(sec))

  <span class="hljs-keyword">let</span> <span class="hljs-title function_">new</span> = (<span class="hljs-params"></span>) =&gt; {
    <span class="hljs-keyword">let</span> keys = <span class="hljs-title function_">generateKeys</span>()
    (keys.<span class="hljs-property">pub</span>, keys.<span class="hljs-property">sec</span>)
  }
}</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
